---
title: JDBC: Connection, Statement, and ResultSet
date: 2023-11-07 15:33:20
toc: true  
categories:  
- java  

---



# JDBC: Connection, Statement, and ResultSet

`Connection`, `Statement`, and `ResultSet` are three core interfaces in JDBC. Each provides a series of methods for managing database interactions. Below are some commonly used methods and properties of these interfaces:

### Connection

The `Connection` interface represents a connection to a specific database. Its primary responsibilities include managing transactions and executing SQL statements.

1. **Creating Statement Objects**
   - `createStatement()`: Creates a `Statement` object for executing static SQL statements.
   - `prepareStatement(String sql)`: Creates a `PreparedStatement` object for executing precompiled SQL statements.
   - `prepareCall(String sql)`: Creates a `CallableStatement` object for executing stored procedures.

2. **Transaction Management**
   - `setAutoCommit(boolean autoCommit)`: Sets whether transactions are automatically committed.
   - `commit()`: Commits the current transaction.
   - `rollback()`: Rolls back the current transaction.

3. **Closing the Connection**
   - `close()`: Immediately releases this `Connection` object's database and JDBC resources rather than waiting for them to be automatically released.

4. **Getting Metadata**
   - `getMetaData()`: Retrieves metadata about the database to which this `Connection` object is connected.

### Statement

The `Statement` interface is used for executing static SQL statements and returning the results they produce.

1. **Executing SQL Statements**
   - `executeQuery(String sql)`: Executes the given SQL statement, which returns a single `ResultSet` object.
   - `executeUpdate(String sql)`: Executes the given SQL statement, such as an INSERT, UPDATE, or DELETE statement, or an SQL statement that returns nothing, such as a DDL statement.

2. **Batch Processing**
   - `addBatch(String sql)`: Adds the given SQL command to the current list of commands for this `Statement` object.
   - `executeBatch()`: Submits a batch of commands to the database for execution.

3. **Resource Management**
   - `close()`: Immediately releases this `Statement` object's database and JDBC resources.

### ResultSet

The `ResultSet` interface represents a table of data returned by a database query, typically generated by executing a query statement.

1. **Traversing the ResultSet**
   - `next()`: Moves the cursor forward one row from its current position.
   - `first()`, `last()`, `beforeFirst()`, `afterLast()`: Move the cursor to specific positions.

2. **Retrieving Data**
   - `getString(int columnIndex)` or `getString(String columnLabel)`: Retrieves the value of the designated column in the current row as a `String`.
   - Similarly, there are methods like `getInt`, `getDouble`, `getDate`, etc., for retrieving different types of data.

3. **Metadata**
   - `getMetaData()`: Retrieves the number, types, and properties of this `ResultSet` object's columns.

4. **Resource Management**
   - `close()`: Immediately releases this `ResultSet` object's database and JDBC resources.

### Example Usage

Below is an example illustrating the use of `Connection`, `Statement`, and `ResultSet`:

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class JDBCExample {
    public static void main(String[] args) {
        Connection con = null;
        Statement stmt = null;
        ResultSet rs = null;

        try {
            // Load the JDBC driver
            Class.forName("com.mysql.cj.jdbc.Driver");

            // Establish the connection
            con = DriverManager.getConnection("jdbc:mysql://localhost:3306/mydb", "username", "password");

            // Create a statement object
            stmt = con.createStatement();

            // Execute a query and get a result set
            rs = stmt.executeQuery("SELECT id, name FROM users");

            // Process the result set
            while (rs.next()) {
                int id = rs.getInt("id");
                String name = rs.getString("name");
                System.out.println("ID: " + id + ", Name: " + name);
            }
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
        } finally {
            try {
                if (rs != null) rs.close();
                if (stmt != null) stmt.close();
                if (con != null) con.close();
            } catch (SQLException se) {
                se.printStackTrace();
            }
        }
    }
}
```

In this example:

- **Connection**: Establishes a connection to the database.
- **Statement**: Executes a SQL query.
- **ResultSet**: Retrieves and processes the results of the query.
- **Resource Management**: Ensures that all resources are closed properly to avoid resource leaks.